<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Audiowide&family=Dancing+Script:wght@400..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="profile.css">
    <title>Home Page</title>
</head>
<body>
    <nav>
        <!-- Logo/Image in the navbar -->
        <div class="logo">
            <a href="home.html">
                <img src="./assents/sitlogo.png" alt="Logo" id="navbar-logo">
            </a>
        </div>

        <ul>
            <li><a href="home.html">Home</a></li>
            <li><a href="About.html">About</a></li>
            <li><a href="Contact.html">Contact</a></li>
            <li><a href="profile.html">Profile</a></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
            <li id="username-display"></li>
            <li><a href="../index.html" id="logout">Logout</a></li>
        </ul>

        <!-- Hamburger menu icon -->
        <div class="hamburger" id="hamburger">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </nav>

    <div class="profile-container">
        <h1>Your Profile</h1>
        <div class="profile-info">
            <img src="https://th.bing.com/th/id/OIP.XbzuN7S5UX8Ov8La8I29nQAAAA?rs=1&pid=ImgDetMain" alt="Profile Picture" class="profile-pic">
            <div class="profile-details">
                <p><strong>Username:</strong> <span id="username"></span></p>
                <p><strong>Email:</strong> <span id="email"></span></p>
                <p><strong>Password:</strong> <span id="password"></span></p>
                <button id="update-password-btn">Update Password</button>
            </div>
        </div>
    </div>

    <!-- Modal for password update -->
    <div id="update-password-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Update Password</h2>
            <form id="update-password-form">
                <input type="password" placeholder="New Password"  id="new-password" required><br>
                <input type="password" placeholder="Confirm New Password"   id="confirm-new-password" required><br>
                <input type="submit" value="Update">
            </form>
        </div>
    </div>
    <footer>
        <p>&copy; 2025 Symbiosis Institute of Technology</p>
    </footer>
    <script>
        var username = sessionStorage.getItem("username");
        var email = sessionStorage.getItem("email");
        var password = sessionStorage.getItem("password");

        document.getElementById("username-display").innerText = username ? `Welcome, ${username}` : "Welcome, Guest";
        document.getElementById("username").innerText = username || "Guest";
        document.getElementById("email").innerText = email || "Not provided";
        document.getElementById("password").innerText = password || "Not provided";

        document.getElementById("logout").addEventListener("click", function() {
            window.location.assign("index.html");
        });

        // Modal functionality
        var modal = document.getElementById("update-password-modal");
        var btn = document.getElementById("update-password-btn");
        var span = document.getElementsByClassName("close")[0];

        btn.onclick = function() {
            modal.style.display = "block";
        }

        span.onclick = function() {
            modal.style.display = "none";
        }

        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        function validatePassword(password) {
            const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[_$])[A-Za-z\d_$]{8,16}$/;
            return regex.test(password);
        }

        document.getElementById("update-password-form").addEventListener("submit", function(event) {
            event.preventDefault();
            var newPassword = document.getElementById("new-password").value;
            var confirmNewPassword = document.getElementById("confirm-new-password").value;

            if (newPassword !== confirmNewPassword) {
                alert("Passwords do not match");
            } else if (!validatePassword(newPassword)) {
                alert("Password must be 8-16 characters long, contain at least one uppercase letter, one lowercase letter, one number, and one special character (_ or $).");
            } else {
                sessionStorage.setItem("password", newPassword);
                document.getElementById("password").innerText = newPassword;
                alert("Password updated successfully");
                modal.style.display = "none";
            }
        });
    </script>
</body>
</html>
